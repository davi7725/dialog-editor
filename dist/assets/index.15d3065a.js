var _e=Object.defineProperty,he=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var te=Object.getOwnPropertySymbols;var ve=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable;var se=(e,t,s)=>t in e?_e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,F=(e,t)=>{for(var s in t||(t={}))ve.call(t,s)&&se(e,s,t[s]);if(te)for(var s of te(t))ge.call(t,s)&&se(e,s,t[s]);return e},L=(e,t)=>he(e,fe(t));import{d as V,u as ye,R as me,D as Y,o as i,c as r,a as o,b as ae,F as xe,r as E,e as Ne,f as x,w as ie,g as q,h as R,n as Ce,i as f,t as K,j as b,k as oe,v as ne,p as M,l as W,C as O,m as Q,q as le,s as $e,L as be,z as ke,x as Se}from"./vendor.20ede4ff.js";const we=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const d of n)if(d.type==="childList")for(const g of d.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&a(g)}).observe(document,{childList:!0,subtree:!0});function s(n){const d={};return n.integrity&&(d.integrity=n.integrity),n.referrerpolicy&&(d.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?d.credentials="include":n.crossorigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function a(n){if(n.ep)return;n.ep=!0;const d=s(n);fetch(n.href,d)}};we();class De{constructor(t,s,a,n){this.name=t,this.playerType=s,this.texts=a,this.fullfilsQuest=n}}class Te{constructor(t,s){this.x=t,this.y=s}}class Ie{constructor(t,s,a,n,d){this.id=t,this.position=s,this.type=a,this.class=n,this.data=d}}class Ae{constructor(t,s,a,n,d){this.id=t,this.source=s,this.target=a,this.sourceHandle=n,this.targetHandle=d}}class re{}var j=(e,t)=>{const s=e.__vccOpts||e;for(const[a,n]of t)s[a]=n;return s};const Pe={class:"save__controls"},He={class:"btn"},Fe=ae(" Load scenario "),Le={inheritAttrs:!1,methods:{onFileChange(e){let t=e.target.files;t==null||!t.length||this.doSomethingWithTheFile(t[0])},onSave(){let e=prompt("Define your file name.");if(this.$props.scenario!=null){var t=new Blob([JSON.stringify(this.$props.scenario)],{type:"text/plain;charset=utf-8"});xe.exports.saveAs(t,e)}},doSomethingWithTheFile(e){let t=new FileReader;t.onload=s=>{if(s.target!=null){let a=JSON.parse(String(s.target.result));console.log(a),this.$emit("json-file-loaded",a)}},t.readAsText(e)}},props:{scenario:re}},Ee=V(L(F({},Le),{setup(e){return ye("example-flow",{nodes:[],edges:[],position:[NaN,NaN],zoom:1}),me(),Y(),(s,a)=>(i(),r("div",Pe,[o("label",{class:"btn",onClick:a[0]||(a[0]=(...n)=>s.onSave&&s.onSave(...n))},"Save scenario"),o("label",He,[o("input",{id:"hiddenInput",type:"file",onChange:a[1]||(a[1]=(...n)=>s.onFileChange&&s.onFileChange(...n))},null,32),Fe])]))}}));var qe=j(Ee,[["__scopeId","data-v-502a117b"]]);const N=e=>(M("data-v-45df8e7e"),e=e(),W(),e),Ve={class:"hidemenu"},Re={key:0},Oe=N(()=>o("div",{class:"description"},"Here you can select the dialogs from this scenario",-1)),Qe=N(()=>o("hr",null,null,-1)),Be=["onClick"],je={key:1},ze=N(()=>o("div",{class:"description"},"Here you can see and edit the quests for the scenario",-1)),Ue=N(()=>o("hr",null,null,-1)),Je=["onUpdate:modelValue"],Ke={key:2},Ye=N(()=>o("div",{class:"description"},"Here you can see and edit the briefing for the scenario",-1)),Me=N(()=>o("hr",null,null,-1)),We={class:"sidemenu"},Xe={key:0},Ge=N(()=>o("div",{class:"description"},"You can drag these nodes to the pane.",-1)),Ze=N(()=>o("hr",null,null,-1)),et=N(()=>o("div",{class:"description"},"Player Nodes",-1)),tt=N(()=>o("hr",null,null,-1)),st=N(()=>o("div",{class:"description"},"NPC Nodes",-1)),ot=["onDragstart"],nt=V({props:{scenario:re},emits:["dialogSelected"],setup(e,{expose:t,emit:s}){const a=e,{nodes:n,edges:d,addNodes:g,setNodes:m,setEdges:k,instance:S,dimensions:C}=Y(),w=(v,h,c,p)=>{v.dataTransfer&&(v.dataTransfer.setData("application/vueflow",h),v.dataTransfer.setData("application/nodeClass",c),v.dataTransfer.setData("application/npcName",p),v.dataTransfer.effectAllowed="move")};let P=null,D=E(null);E(null),t({reset:()=>{P=null,D.value=null,m([]),k([])}});const z=(v,h)=>{console.log(D),P=v,D.value=h,s("dialogSelected",h),m(v.nodes),k(v.edges)},U=()=>{var v;if(P!=null){let h=prompt("Please enter the new NPC name","");(v=P.actors)==null||v.push(h)}},J=()=>{a.scenario!=null&&a.scenario.quests.push("")};return(v,h)=>{const c=Ne("container");return i(),r(q,null,[o("div",Ve,[x(c,null,{default:ie(()=>[e.scenario!=null?(i(),r("aside",Re,[Oe,Qe,(i(!0),r(q,null,R(e.scenario.conversations,(p,y)=>(i(),r("div",{key:y,class:Ce(["vue-flow__node-default",{active:y===f(D)}]),onClick:H=>z(p,y)}," Dialog "+K(y),11,Be))),128))])):b("",!0),e.scenario!=null?(i(),r("aside",je,[ze,Ue,(i(!0),r(q,null,R(e.scenario.quests,(p,y)=>(i(),r("div",{key:y},[oe(o("textarea",{name:"quest","onUpdate:modelValue":H=>e.scenario.quests[y]=H,rows:""},null,8,Je),[[ne,e.scenario.quests[y]]])]))),128)),o("button",{onClick:J},"Add Quest")])):b("",!0),e.scenario!=null?(i(),r("aside",Ke,[Ye,Me,oe(o("textarea",{name:"briefing",id:"briefing","onUpdate:modelValue":h[0]||(h[0]=p=>e.scenario.briefing=p),rows:"10"},null,512),[[ne,e.scenario.briefing]])])):b("",!0)]),_:1})]),o("div",We,[f(D)!=null?(i(),r("aside",Xe,[Ge,Ze,et,o("div",{class:"vue-flow__node-default player1",draggable:!0,onDragstart:h[1]||(h[1]=p=>w(p,"playerNode","player1"))}," Player1 Node ",32),o("div",{class:"vue-flow__node-default player2",draggable:!0,onDragstart:h[2]||(h[2]=p=>w(p,"playerNode","player2"))}," Player2 Node ",32),o("div",{class:"vue-flow__node-default playerAll",draggable:!0,onDragstart:h[3]||(h[3]=p=>w(p,"playerNode","playerAll"))}," All Players Node ",32),tt,st,(i(!0),r(q,null,R(e.scenario.conversations[f(D)].actors,(p,y)=>(i(),r("div",{key:y,class:"vue-flow__node-default npc",draggable:!0,onDragstart:H=>w(H,"npcNode","npc",p)},K(p),41,ot))),128)),o("button",{onClick:U},"Add NPC")])):b("",!0)])],64)}}});var lt=j(nt,[["__scopeId","data-v-45df8e7e"]]);const X=e=>(M("data-v-647cd1d8"),e=e(),W(),e),at={style:{position:"relative"}},it=ae(" NPC - "),rt=X(()=>o("hr",null,null,-1)),dt=X(()=>o("div",null," Responses: ",-1)),ct={id:"texts-npcs"},ut=["value","onInput"],pt=["onClick"],_t=X(()=>o("br",null,null,-1)),ht={key:0,class:"footer"},ft={inheritAttrs:!1,mounted(){document.querySelectorAll("textarea").forEach(e=>{e.style.height="",e.style.height=e.scrollHeight+"px"})}},vt=V(L(F({},ft),{props:{id:null,data:null},setup(e){const t=e,s={background:"#555",position:"absolute",top:"20px"};L(F({},s),{position:"relative",left:"15px",top:"0px",transform:"0"});const a=()=>{t.data.texts.push("")},n=(g,m)=>{t.data.texts[m]=g.target.value},d=g=>{t.data.texts.splice(g,1)};return(g,m)=>(i(),r("div",at,[x(f(Q),{type:"target",id:"gi1",position:f(O).Left,style:s,"on-connect":t.data.onConnect},null,8,["position","on-connect"]),x(f(Q),{type:"source",id:"go1",position:f(O).Right,style:s,"on-connect":t.data.onConnect},null,8,["position","on-connect"]),o("div",null,[it,o("strong",null,K(e.data.name),1)]),rt,dt,o("ul",ct,[(i(!0),r(q,null,R(e.data.texts,(k,S)=>(i(),r("li",{key:S,style:{position:"relative"}},[o("textarea",{class:"nodrag",value:e.data.texts[S],onInput:C=>n(C,S),oninput:'this.style.height = "";this.style.height = this.scrollHeight + "px"'},null,40,ut),o("span",{onClick:C=>d(S)},"x",8,pt)]))),128))]),_t,o("button",{onClick:a},"Add text"),t.data.fullfilsQuest?(i(),r("div",ht,"Fullfils Quest")):b("",!0)]))}}));var gt=j(vt,[["__scopeId","data-v-647cd1d8"]]);const G=e=>(M("data-v-3fbe38b4"),e=e(),W(),e),yt={style:{position:"relative"}},mt={key:0},xt={key:1},Nt={key:2},Ct=G(()=>o("hr",null,null,-1)),$t=G(()=>o("div",null," Responses: ",-1)),bt={id:"texts-npcs"},kt=["value","onInput"],St=["onClick"],wt=G(()=>o("br",null,null,-1)),Dt={key:0,class:"footer"},Tt={inheritAttrs:!1,mounted(){document.querySelectorAll("textarea").forEach(e=>{e.style.height="",e.style.height=e.scrollHeight+"px"})}},It=V(L(F({},Tt),{props:{id:null,data:null},setup(e){const t=e,s={background:"#555",position:"absolute",top:"20px"},a=L(F({},s),{position:"relative",left:"15px",top:"0px",transform:"0"}),n=()=>{t.data.texts.push("")},d=(m,k)=>{t.data.texts[k]=m.target.value},g=m=>{t.data.texts.splice(m,1)};return(m,k)=>(i(),r("div",yt,[x(f(Q),{type:"target",id:"gi1",position:f(O).Left,style:s,"on-connect":t.data.onConnect},null,8,["position","on-connect"]),x(f(Q),{type:"source",id:"go1",position:f(O).Right,style:s,"on-connect":t.data.onConnect},null,8,["position","on-connect"]),o("div",null,[t.data.playerType=="player1"?(i(),r("strong",mt,"Player 1")):b("",!0),t.data.playerType=="player2"?(i(),r("strong",xt,"Player 2")):b("",!0),t.data.playerType=="playerAll"?(i(),r("strong",Nt,"All Players")):b("",!0)]),Ct,$t,o("ul",bt,[(i(!0),r(q,null,R(e.data.texts,(S,C)=>(i(),r("li",{key:C,style:{position:"relative"}},[o("textarea",{class:"nodrag",value:e.data.texts[C],onInput:w=>d(w,C),oninput:'this.style.height = "";this.style.height = this.scrollHeight + "px"'},null,40,kt),x(f(Q),{id:"p"+C,type:"source",position:f(O).Right,style:a},null,8,["id","position"]),o("span",{onClick:w=>g(C)},"x",8,St)]))),128))]),wt,o("button",{onClick:n},"Add response"),t.data.fullfilsQuest?(i(),r("div",Dt,"Fullfils Quest")):b("",!0)]))}}));var At=j(It,[["__scopeId","data-v-3fbe38b4"]]);const Pt=V({setup(e){const t=[];let s=0;const a=()=>`node_${s++}`,{instance:n,onConnect:d,nodes:g,edges:m,addEdges:k,addNodes:S,setNodes:C,setEdges:w,onEdgesChange:P,onNodesChange:D}=Y();let _=E(null);const z=()=>c.value!=null&&_.value!=null?c.value.conversations[_.value].nodes.length+1:null;D(l=>{console.log(l),l.forEach(u=>{var $,I;if(c.value!=null&&_.value!=null){if(u.type==="position"){let T=c.value.conversations[_.value].nodes.findIndex(function(A){return A.id==u.id});T>=0&&(c.value.conversations[_.value].nodes[T].position.x=($=u.position)==null?void 0:$.x,c.value.conversations[_.value].nodes[T].position.y=(I=u.position)==null?void 0:I.y)}else if(u.type==="remove"){let T=c.value.conversations[_.value].nodes.findIndex(function(A){return A.id==u.id});c.value.conversations[_.value].nodes.splice(T,1)}}})}),P(l=>{l.forEach(u=>{if(u.type==="remove"&&c.value!=null&&_.value!=null){let $=c.value.conversations[_.value].edges.findIndex(function(I){return I.id==u.id});c.value.conversations[_.value].edges.splice($,1)}})}),d(l=>{if(k([l]),c.value!=null&&_.value!=null){let u="edge-"+l.source+l.sourceHandle+"-"+l.target+l.targetHandle;c.value.conversations[_.value].edges.push(new Ae(u,l.source,l.target,l.sourceHandle,l.targetHandle))}});const U=l=>{l.preventDefault(),l.dataTransfer&&(l.dataTransfer.dropEffect="move")},J=l=>{},v=l=>{var u,$,I,T;if(n.value){const A=(u=l.dataTransfer)==null?void 0:u.getData("application/vueflow"),B=($=l.dataTransfer)==null?void 0:$.getData("application/nodeClass"),ee=(I=l.dataTransfer)==null?void 0:I.getData("application/npcName"),de=n.value.project({x:l.clientX,y:l.clientY-40}),ce={id:a(),type:A,class:B,data:{onChange:J,onConnect:d,name:ee,texts:[],playerType:B,fullfilsQuest:!1},connectable:!0,position:de,label:`${A} node`};S([ce]);let ue="node"+z(),pe=new Ie(ue,new Te(l.clientX,l.clientY-40),A,B,new De(ee,B,[],!1));(T=c.value)==null||T.conversations[_.value].nodes.push(pe)}},h={npcNode:le(gt),playerNode:le(At)},c=E(null),p=E(null),y=l=>{var u;c.value=null,c.value=l,_.value=null,(u=p.value)==null||u.reset()},H=l=>{_.value=l},Z=E(t);return(l,u)=>(i(),r("div",{class:"dndflow",onDrop:v},[x(f($e),{modelValue:Z.value,"onUpdate:modelValue":u[0]||(u[0]=$=>Z.value=$),onDragover:U,"node-types":h},{default:ie(()=>[x(f(be),{variant:f(ke).Lines,"pattern-color":"#4d4d4d",gap:"25"},null,8,["variant"]),x(qe,{scenario:c.value,onJsonFileLoaded:y},null,8,["scenario"]),x(lt,{scenario:c.value,onDialogSelected:H,ref_key:"sideBar",ref:p},null,8,["scenario"])]),_:1},8,["modelValue"])],32))}});const Ht={style:{height:"100vh"}},Ft=V({setup(e){return(t,s)=>(i(),r("div",Ht,[x(Pt)]))}});Se(Ft).mount("#app");
